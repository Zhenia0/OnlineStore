function cov_2ht7n39vba(){var path="C:\\Users\\Lenovo\\Desktop\\CourseWork\\server\\controllers\\deviceController.js";var hash="202e3197f181d50bc1e549aeef9c63783a212b20";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Lenovo\\Desktop\\CourseWork\\server\\controllers\\deviceController.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:28}},"1":{start:{line:2,column:13},end:{line:2,column:28}},"2":{start:{line:3,column:29},end:{line:3,column:56}},"3":{start:{line:4,column:17},end:{line:4,column:45}},"4":{start:{line:8,column:8},end:{line:29,column:9}},"5":{start:{line:9,column:55},end:{line:9,column:63}},"6":{start:{line:10,column:26},end:{line:10,column:35}},"7":{start:{line:11,column:27},end:{line:11,column:45}},"8":{start:{line:12,column:12},end:{line:12,column:69}},"9":{start:{line:13,column:27},end:{line:13,column:93}},"10":{start:{line:15,column:12},end:{line:24,column:13}},"11":{start:{line:16,column:16},end:{line:16,column:39}},"12":{start:{line:17,column:16},end:{line:23,column:17}},"13":{start:{line:18,column:20},end:{line:22,column:22}},"14":{start:{line:26,column:12},end:{line:26,column:35}},"15":{start:{line:28,column:12},end:{line:28,column:48}},"16":{start:{line:33,column:45},end:{line:33,column:54}},"17":{start:{line:34,column:8},end:{line:34,column:24}},"18":{start:{line:35,column:8},end:{line:35,column:26}},"19":{start:{line:36,column:21},end:{line:36,column:41}},"20":{start:{line:38,column:8},end:{line:40,column:9}},"21":{start:{line:39,column:12},end:{line:39,column:67}},"22":{start:{line:41,column:8},end:{line:43,column:9}},"23":{start:{line:42,column:12},end:{line:42,column:85}},"24":{start:{line:44,column:8},end:{line:46,column:9}},"25":{start:{line:45,column:12},end:{line:45,column:84}},"26":{start:{line:47,column:8},end:{line:49,column:9}},"27":{start:{line:48,column:12},end:{line:48,column:93}},"28":{start:{line:50,column:8},end:{line:50,column:32}},"29":{start:{line:54,column:21},end:{line:54,column:31}},"30":{start:{line:55,column:23},end:{line:60,column:9}},"31":{start:{line:61,column:8},end:{line:61,column:31}},"32":{start:{line:65,column:0},end:{line:65,column:39}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:4},end:{line:7,column:5}},loc:{start:{line:7,column:32},end:{line:30,column:5}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:29},end:{line:17,column:30}},loc:{start:{line:18,column:20},end:{line:22,column:22}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:4},end:{line:32,column:5}},loc:{start:{line:32,column:26},end:{line:51,column:5}},line:32},"3":{name:"(anonymous_3)",decl:{start:{line:53,column:4},end:{line:53,column:5}},loc:{start:{line:53,column:26},end:{line:62,column:5}},line:53}},branchMap:{"0":{loc:{start:{line:15,column:12},end:{line:24,column:13}},type:"if",locations:[{start:{line:15,column:12},end:{line:24,column:13}},{start:{line:15,column:12},end:{line:24,column:13}}],line:15},"1":{loc:{start:{line:34,column:15},end:{line:34,column:24}},type:"binary-expr",locations:[{start:{line:34,column:15},end:{line:34,column:19}},{start:{line:34,column:23},end:{line:34,column:24}}],line:34},"2":{loc:{start:{line:35,column:16},end:{line:35,column:26}},type:"binary-expr",locations:[{start:{line:35,column:16},end:{line:35,column:21}},{start:{line:35,column:25},end:{line:35,column:26}}],line:35},"3":{loc:{start:{line:38,column:8},end:{line:40,column:9}},type:"if",locations:[{start:{line:38,column:8},end:{line:40,column:9}},{start:{line:38,column:8},end:{line:40,column:9}}],line:38},"4":{loc:{start:{line:38,column:11},end:{line:38,column:30}},type:"binary-expr",locations:[{start:{line:38,column:11},end:{line:38,column:19}},{start:{line:38,column:23},end:{line:38,column:30}}],line:38},"5":{loc:{start:{line:41,column:8},end:{line:43,column:9}},type:"if",locations:[{start:{line:41,column:8},end:{line:43,column:9}},{start:{line:41,column:8},end:{line:43,column:9}}],line:41},"6":{loc:{start:{line:41,column:11},end:{line:41,column:29}},type:"binary-expr",locations:[{start:{line:41,column:11},end:{line:41,column:18}},{start:{line:41,column:22},end:{line:41,column:29}}],line:41},"7":{loc:{start:{line:44,column:8},end:{line:46,column:9}},type:"if",locations:[{start:{line:44,column:8},end:{line:46,column:9}},{start:{line:44,column:8},end:{line:46,column:9}}],line:44},"8":{loc:{start:{line:44,column:11},end:{line:44,column:29}},type:"binary-expr",locations:[{start:{line:44,column:11},end:{line:44,column:19}},{start:{line:44,column:23},end:{line:44,column:29}}],line:44},"9":{loc:{start:{line:47,column:8},end:{line:49,column:9}},type:"if",locations:[{start:{line:47,column:8},end:{line:49,column:9}},{start:{line:47,column:8},end:{line:49,column:9}}],line:47},"10":{loc:{start:{line:47,column:11},end:{line:47,column:28}},type:"binary-expr",locations:[{start:{line:47,column:11},end:{line:47,column:18}},{start:{line:47,column:22},end:{line:47,column:28}}],line:47}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"202e3197f181d50bc1e549aeef9c63783a212b20"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2ht7n39vba=function(){return actualCoverage;};}return actualCoverage;}cov_2ht7n39vba();const uuid=(cov_2ht7n39vba().s[0]++,require('uuid'));const path=(cov_2ht7n39vba().s[1]++,require('path'));const{Device,DeviceInfo}=(cov_2ht7n39vba().s[2]++,require('../models/models'));const ApiError=(cov_2ht7n39vba().s[3]++,require('../error/ApiError'));class DeviceController{async create(req,res,next){cov_2ht7n39vba().f[0]++;cov_2ht7n39vba().s[4]++;try{let{name,price,brandId,typeId,info}=(cov_2ht7n39vba().s[5]++,req.body);const{img}=(cov_2ht7n39vba().s[6]++,req.files);let fileName=(cov_2ht7n39vba().s[7]++,uuid.v4()+".jpg");cov_2ht7n39vba().s[8]++;img.mv(path.resolve(__dirname,'..','static',fileName));const device=(cov_2ht7n39vba().s[9]++,await Device.create({name,price,brandId,typeId,img:fileName}));cov_2ht7n39vba().s[10]++;if(info){cov_2ht7n39vba().b[0][0]++;cov_2ht7n39vba().s[11]++;info=JSON.parse(info);cov_2ht7n39vba().s[12]++;info.forEach(i=>{cov_2ht7n39vba().f[1]++;cov_2ht7n39vba().s[13]++;return DeviceInfo.create({title:i.title,description:i.description,deviceId:device.id});});}else{cov_2ht7n39vba().b[0][1]++;}cov_2ht7n39vba().s[14]++;return res.json(device);}catch(e){cov_2ht7n39vba().s[15]++;next(ApiError.badRequest(e.message));}}async getAll(req,res){cov_2ht7n39vba().f[2]++;let{brandId,typeId,limit,page}=(cov_2ht7n39vba().s[16]++,req.query);cov_2ht7n39vba().s[17]++;page=(cov_2ht7n39vba().b[1][0]++,page)||(cov_2ht7n39vba().b[1][1]++,1);cov_2ht7n39vba().s[18]++;limit=(cov_2ht7n39vba().b[2][0]++,limit)||(cov_2ht7n39vba().b[2][1]++,9);let offset=(cov_2ht7n39vba().s[19]++,page*limit-limit);let devices;cov_2ht7n39vba().s[20]++;if((cov_2ht7n39vba().b[4][0]++,!brandId)&&(cov_2ht7n39vba().b[4][1]++,!typeId)){cov_2ht7n39vba().b[3][0]++;cov_2ht7n39vba().s[21]++;devices=await Device.findAndCountAll({limit,offset});}else{cov_2ht7n39vba().b[3][1]++;}cov_2ht7n39vba().s[22]++;if((cov_2ht7n39vba().b[6][0]++,brandId)&&(cov_2ht7n39vba().b[6][1]++,!typeId)){cov_2ht7n39vba().b[5][0]++;cov_2ht7n39vba().s[23]++;devices=await Device.findAndCountAll({where:{brandId},limit,offset});}else{cov_2ht7n39vba().b[5][1]++;}cov_2ht7n39vba().s[24]++;if((cov_2ht7n39vba().b[8][0]++,!brandId)&&(cov_2ht7n39vba().b[8][1]++,typeId)){cov_2ht7n39vba().b[7][0]++;cov_2ht7n39vba().s[25]++;devices=await Device.findAndCountAll({where:{typeId},limit,offset});}else{cov_2ht7n39vba().b[7][1]++;}cov_2ht7n39vba().s[26]++;if((cov_2ht7n39vba().b[10][0]++,brandId)&&(cov_2ht7n39vba().b[10][1]++,typeId)){cov_2ht7n39vba().b[9][0]++;cov_2ht7n39vba().s[27]++;devices=await Device.findAndCountAll({where:{typeId,brandId},limit,offset});}else{cov_2ht7n39vba().b[9][1]++;}cov_2ht7n39vba().s[28]++;return res.json(devices);}async getOne(req,res){cov_2ht7n39vba().f[3]++;const{id}=(cov_2ht7n39vba().s[29]++,req.params);const device=(cov_2ht7n39vba().s[30]++,await Device.findOne({where:{id},include:[{model:DeviceInfo,as:'info'}]}));cov_2ht7n39vba().s[31]++;return res.json(device);}}cov_2ht7n39vba().s[32]++;module.exports=new DeviceController();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRldmljZUNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsidXVpZCIsInJlcXVpcmUiLCJwYXRoIiwiRGV2aWNlIiwiRGV2aWNlSW5mbyIsIkFwaUVycm9yIiwiRGV2aWNlQ29udHJvbGxlciIsImNyZWF0ZSIsInJlcSIsInJlcyIsIm5leHQiLCJuYW1lIiwicHJpY2UiLCJicmFuZElkIiwidHlwZUlkIiwiaW5mbyIsImJvZHkiLCJpbWciLCJmaWxlcyIsImZpbGVOYW1lIiwidjQiLCJtdiIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJkZXZpY2UiLCJKU09OIiwicGFyc2UiLCJmb3JFYWNoIiwiaSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkZXZpY2VJZCIsImlkIiwianNvbiIsImUiLCJiYWRSZXF1ZXN0IiwibWVzc2FnZSIsImdldEFsbCIsImxpbWl0IiwicGFnZSIsInF1ZXJ5Iiwib2Zmc2V0IiwiZGV2aWNlcyIsImZpbmRBbmRDb3VudEFsbCIsIndoZXJlIiwiZ2V0T25lIiwicGFyYW1zIiwiZmluZE9uZSIsImluY2x1ZGUiLCJtb2RlbCIsImFzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6ImcvS0FlWTsyRkFmWixLQUFNQSxDQUFBQSxJQUFJLDBCQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNLENBQUNFLE1BQUQsQ0FBU0MsVUFBVCwyQkFBdUJILE9BQU8sQ0FBQyxrQkFBRCxDQUE5QixDQUFOLENBQ0EsS0FBTUksQ0FBQUEsUUFBUSwwQkFBR0osT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBZCxDQUVBLEtBQU1LLENBQUFBLGdCQUFnQixDQUNOLEtBQU5DLENBQUFBLE1BQU0sQ0FBQ0MsR0FBRCxDQUFNQyxHQUFOLENBQVdDLElBQVgsQ0FBZ0IsaURBQ3hCLEdBQUcsQ0FDQyxHQUFJLENBQUNDLElBQUQsQ0FBT0MsS0FB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SixDQUFWLENBQXFCLHFEQUNqQjRCLE9BQU8sQ0FBRyxLQUFNdkMsQ0FBQUEsTUFBTSxDQUFDd0MsZUFBUCxDQUF1QixDQUFDQyxLQUFLLENBQUUsQ0FBQzlCLE1BQUQsQ0FBU0QsT0FBVCxDQUFSLENBQTJCeUIsS0FBM0IsQ0FBa0NHLE1BQWxDLENBQXZCLENBQWhCLENBQ0gsQ0FGRCxpQ0Fma0IseUJBa0JsQixNQUFPaEMsQ0FBQUEsR0FBRyxDQUFDd0IsSUFBSixDQUFTUyxPQUFULENBQVAsQ0FDSCxDQUVXLEtBQU5HLENBQUFBLE1BQU0sQ0FBQ3JDLEdBQUQsQ0FBTUMsR0FBTixDQUFVLHlCQUNsQixLQUFNLENBQUN1QixFQUFELDRCQUFPeEIsR0FBRyxDQUFDc0MsTUFBWCxDQUFOLENBQ0EsS0FBTXRCLENBQUFBLE1BQU0sMkJBQUcsS0FBTXJCLENBQUFBLE1BQU0sQ0FBQzRDLE9BQVAsQ0FDakIsQ0FDSUgsS0FBSyxDQUFFLENBQUNaLEVBQUQsQ0FEWCxDQUVJZ0IsT0FBTyxDQUFFLENBQUMsQ0FBQ0MsS0FBSyxDQUFFN0MsVUFBUixDQUFvQjhDLEVBQUUsQ0FBRSxNQUF4QixDQUFELENBRmIsQ0FEaUIsQ0FBVCxDQUFaLENBRmtCLHlCQVFsQixNQUFPekMsQ0FBQUEsR0FBRyxDQUFDd0IsSUFBSixDQUFTVCxNQUFULENBQVAsQ0FDSCxDQXhEaUIsQyx5QkEyRHRCMkIsTUFBTSxDQUFDQyxPQUFQLENBQWlCLEdBQUk5QyxDQUFBQSxnQkFBSixFQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHV1aWQgPSByZXF1aXJlKCd1dWlkJylcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuY29uc3Qge0RldmljZSwgRGV2aWNlSW5mb30gPSByZXF1aXJlKCcuLi9tb2RlbHMvbW9kZWxzJylcclxuY29uc3QgQXBpRXJyb3IgPSByZXF1aXJlKCcuLi9lcnJvci9BcGlFcnJvcicpXHJcblxyXG5jbGFzcyBEZXZpY2VDb250cm9sbGVye1xyXG4gICAgYXN5bmMgY3JlYXRlKHJlcSwgcmVzLCBuZXh0KXtcclxuICAgICAgICB0cnl7XHJcbiAgICAgICAgICAgIGxldCB7bmFtZSwgcHJpY2UsIGJyYW5kSWQsIHR5cGVJZCwgaW5mb30gPSByZXEuYm9keVxyXG4gICAgICAgICAgICBjb25zdCB7aW1nfSA9IHJlcS5maWxlc1xyXG4gICAgICAgICAgICBsZXQgZmlsZU5hbWUgPSB1dWlkLnY0KCkgKyBcIi5qcGdcIlxyXG4gICAgICAgICAgICBpbWcubXYocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJ3N0YXRpYycsIGZpbGVOYW1lKSlcclxuICAgICAgICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgRGV2aWNlLmNyZWF0ZSh7bmFtZSwgcHJpY2UsIGJyYW5kSWQsIHR5cGVJZCwgaW1nOiBmaWxlTmFtZX0pO1xyXG5cclxuICAgICAgICAgICAgaWYoaW5mbyl7XHJcbiAgICAgICAgICAgICAgICBpbmZvID0gSlNPTi5wYXJzZShpbmZvKVxyXG4gICAgICAgICAgICAgICAgaW5mby5mb3JFYWNoKGkgPT5cclxuICAgICAgICAgICAgICAgICAgICBEZXZpY2VJbmZvLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBpLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlSWQ6ZGV2aWNlLmlkXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKGRldmljZSlcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIG5leHQoQXBpRXJyb3IuYmFkUmVxdWVzdChlLm1lc3NhZ2UpKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXRBbGwocmVxLCByZXMpe1xyXG4gICAgICAgIGxldCB7YnJhbmRJZCwgdHlwZUlkLCBsaW1pdCwgcGFnZX0gPSByZXEucXVlcnlcclxuICAgICAgICBwYWdlID0gcGFnZSB8fCAxXHJcbiAgICAgICAgbGltaXQgPSBsaW1pdCB8fCA5XHJcbiAgICAgICAgbGV0IG9mZnNldCA9IHBhZ2UgKiBsaW1pdCAtIGxpbWl0XHJcbiAgICAgICAgbGV0IGRldmljZXM7XHJcbiAgICAgICAgaWYoIWJyYW5kSWQgJiYgIXR5cGVJZCl7XHJcbiAgICAgICAgICAgIGRldmljZXMgPSBhd2FpdCBEZXZpY2UuZmluZEFuZENvdW50QWxsKHtsaW1pdCwgb2Zmc2V0fSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoYnJhbmRJZCAmJiAhdHlwZUlkKXtcclxuICAgICAgICAgICAgZGV2aWNlcyA9IGF3YWl0IERldmljZS5maW5kQW5kQ291bnRBbGwoe3doZXJlOiB7YnJhbmRJZH0sIGxpbWl0LCBvZmZzZXR9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZighYnJhbmRJZCAmJiB0eXBlSWQpe1xyXG4gICAgICAgICAgICBkZXZpY2VzID0gYXdhaXQgRGV2aWNlLmZpbmRBbmRDb3VudEFsbCh7d2hlcmU6IHt0eXBlSWR9LCBsaW1pdCwgb2Zmc2V0fSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoYnJhbmRJZCAmJiB0eXBlSWQpe1xyXG4gICAgICAgICAgICBkZXZpY2VzID0gYXdhaXQgRGV2aWNlLmZpbmRBbmRDb3VudEFsbCh7d2hlcmU6IHt0eXBlSWQsIGJyYW5kSWR9LCBsaW1pdCwgb2Zmc2V0fSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKGRldmljZXMpXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZ2V0T25lKHJlcSwgcmVzKXtcclxuICAgICAgICBjb25zdCB7aWR9ID0gcmVxLnBhcmFtc1xyXG4gICAgICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IERldmljZS5maW5kT25lKFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB3aGVyZToge2lkfSxcclxuICAgICAgICAgICAgICAgIGluY2x1ZGU6IFt7bW9kZWw6IERldmljZUluZm8sIGFzOiAnaW5mbyd9XVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIClcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oZGV2aWNlKVxyXG4gICAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBEZXZpY2VDb250cm9sbGVyKCkiXX0=